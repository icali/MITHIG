\section{Introduction}
\label{sec:intro}

Relativistic heavy ion collisions allow experimental studies of quark-gluon plasma (QGP), the equilibrated high temperature state of de-confined quarks and gluons. At the Large Hadron Collider (LHC), the abundant production of hard probes such as vector bosons, heavy quarks, jets and quarkonia produced in the highest energy heavy ion collisions has opened a new era in the characterization of QGP, providing new information on initial state properties, parton energy loss and color screening. The capabilities of the Compact Muon Solenoid (CMS) detector in the detection of high momentum photons, electrons, muons, charged particles and jets have proven to be a unique match for the opportunities at the LHC. A key aspect of this success has been the convergence of detector needs for precision measurements in pp discovery physics in a high luminosity, high pileup environment and for QGP studies in the high multiplicity PbPb collisions. This convergence has allowed CMS to adapt a large number of new analysis techniques to studies of heavy ion collisions, such as particle-flow jet reconstruction, studies of jet substructures, lifetime fits for secondary $J/\psi$ studies,  b- and c-tagging of jets, missing $p_T$ measurements of W production and energy flow in dijet events. 

The full power of these and other techniques will be exploited in future heavy ion studies beginning in 2018 and Run III, when an increase in the collision energy to $\sqrt{s_{_{NN}}} = 5.02$~TeV and an eventual increase in PbPb collision rate to as high as $\sim 30-50$~kHz will enhance the production rate of hard probes by more than an order of magnitude. In this high energy and high luminosity era, CMS will undertake precision studies of complex observables such as $\gamma$-, Z$^0$- and W$^\pm$-jet correlations, heavy flavor jet quenching, multi-jet correlations and the azimuthal anisotropy of high \pt\ jets and quarkonia. Recently, extensive studies of fully reconstructed heavy flavor mesons such as $D^0$, $B^+$ in heavy ion collisions also show that CMS is ideally suited for the studies of heavy flavor production and heavy quark energy loss in the quark-gluon plasma.

The CMS trigger and data acquisition system is the key to achieving the ultimate high \pt physics reach in heavy ion collisions. Uniquely, the CMS trigger system only has two main components, the hardware based Level-1 (L1) trigger and the High-Level Trigger, which is implemented as "offline" algorithms running on a large computer farm with access to the full event information.  
The conceptual aspects of applying this system to heavy ion collisions, which are characterized by much lower rate, but much higher multiplicity than those encountered in pp collisions, were first developed by the US CMS HI group (see, e.g.\ \cite{Roland:2007is}). The HLT trigger work formed the basis for our previous proposals to the DOE Office of Nuclear Physics. As we demonstrated in that proposal, triggering on high \pt probes for PbPb collision rates up to several kHz (i.e.\ the design value for PbPb) is possible using event rejection solely or mostly at the HLT level. In the 2011 PbPb run, this allowed a reduction of the event rate to storage by more than
an order of magnitude compared to the collision rate, without prescaling the most interesting high \pt\ observables. In the 2015 PbPb run, the heavy flavor meson triggers developed by the US CMS HI group from a previous DOE proposal was deployed for the first time. For instance, those triggers increased the high \pt\ $D^0$ meson statistics in pp (PbPb) collisions by a factor of 600 (20) which opened a new era for the precision heavy flavor physics in heavy ion collisions.

It has now become clear that the LHC will be able to significantly exceed the PbPb design luminosity in future runs, possibly reaching up to 50~kHz already in Run III. This will place an even greater emphasis on the CMS trigger and DAQ system. In 2017, a new 4-layer pixel detector will be installed in CMS which will greatly improve the impact parameter resolution of the charged tracks. This is an uniquie opportunity to combine the capability of CMS for the studies of high \pt\ probes with heavy flavor program down to \pt$\sim 0$, complementary to the physics goal of the O(100M) ALICE upgrade. Moreover, a stage-2 upgrade of the Level 1 trigger system will be commissioned. This requires improvement in the front end detector readout bandwidth in PbPb ccollisions, as well as significant development on the trigger strategy for the data-taking in 2018 and beyond such that CMS could provide unbiased single track, heavy flavor meson, jet triggers, that are critical for the CMS physics program, and at the same time record a large statistics Minimum-Bias triggered sample which could be used to for the studies of low \pt\ heavy flavor mesons. This necessates the development of underlying event background subtraction for the stage 2 L1 system and improvements in the detector readout to increase the maximum L1 accept rate during the PbPb data-taking period.

In this proposal, we will present the CMS L1 rate upgrade design and demonstrate that the planned upgrade delivers the needed capability to record heavy flavor meson and jets over a very wide kinematics range at the full delivered rate in high luminosity PbPb runs in 2018 and beyond. This new system will need to be commissioned by 2017-2018, before the next heavy ion running period at the end of 2018, to make successful PbPb data taking possible. Section~\ref{sec:physics} describes the expected performance of the upgraded trigger for several examples of critical measurements, compared to the the limitations of the current system. The CMS trigger system and the technical details of the proposed upgrade project are described in Section~\ref{sec:calo}. In Section~\ref{sec:hiTrigPerf} the trigger performance based on simulation and extrapolation are illustrated. Finally, the proposed schedule, management plan and the budget are described in Sections~\ref{sec:management} and~\ref{sec:funding}.

